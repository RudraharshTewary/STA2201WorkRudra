"0","library(tidyverse)"
"0","theta_model1 <- rstan::extract(mod1)$theta"
"0","theta_model2 <- rstan::extract(mod2)$theta"
"0","theta_model3 <- rstan::extract(mod3)$theta"
"0",""
"0","# Calculate mean theta estimates for each model"
"0","mean_theta_model1 <- apply(theta_model1, 2, mean)"
"0","mean_theta_model2 <- apply(theta_model2, 2, mean)"
"0","mean_theta_model3 <- apply(theta_model3, 2, mean)"
"0",""
"0","# Question 3: Create plots"
"0","# Plot 1: Estimated theta_i across Regions"
"0","region_names <- 1:length(mean_theta_model1)"
"0","plot_data <- data.frame(region = seq(1,195), "
"0","                         theta_model1 = mean_theta_model1,"
"0","                         theta_model2 = mean_theta_model2,"
"0","                         theta_model3 = mean_theta_model3,"
"0","                         observe = aff.i-mean(aff.i))"
"0","ggplot(plot_data, aes(x = region)) +"
"0","  geom_point(aes(y = theta_model1), color = ""blue"", size = 3) +"
"0","  geom_point(aes(y = theta_model2), color = ""red"", size = 3) +"
"0","  geom_point(aes(y = theta_model3), color = ""green"", size = 3) +"
"0","  geom_point(aes(y = observe), color = 'black', size = 3)+"
"0","  labs(x = ""Region"", y = ""Estimated theta_i"","
"0","       title = ""Estimated theta_i across Regions"") +"
"0","  theme_minimal()"
